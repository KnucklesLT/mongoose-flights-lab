<%- include('../partials/html-head') %>
<link rel="stylesheet" href="/stylesheets/flights/index.css">
<%- include('../partials/nav') %>

<main>
  <h1><%= title %></h1>
  <table>
    <thead>
      <tr>
        <th>Airline</th>
        <th>Airport</th>
        <th>Flight No.</th>
        <th>Departs</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <%# Write the line of EJS to iterate over flights using forEach %>
      <% flights.forEach(flight => { %>
        <tr <%- flight.departs < new Date() ? 'style="color: red;"' : ''%> >
          <td><%= flight.airline%></td>
          <td><%= flight.airport %></td>
          <td><%= flight.flightNo %></td>
          <td><%= flight.departs.toDateString() %> </td>
          <td><a href="/flights/<%= flight._id %>">Details</a></td>
          <td>
            <form 
              action="/flights/<%= flight._id %>?_method=DELETE" 
              method="post"
              class="delete-form"
            >
              <button type="submit">X</button>
            </form>
          </td>
        </tr>
      <% }) %>
      <%# Close the forEach using EJS here %>
    </tbody>
  </table>
</main>

<%- include('../partials/footer') %>